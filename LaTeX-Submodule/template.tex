% Packages

%% Math enhancements
\usepackage{amsmath} % Misc enhancements to math equations
\usepackage{cancel} % Draw diagonal lines and arrows in math equations
\usepackage{mathtools} % Starred versions of amsmath matrix environments; Multiline, cases, gathered environment
\usepackage{chngcntr} % Reset counter within sections
\usepackage{interval} % Format intervals
\intervalconfig{
    soft open fences
}

%% Symbols
\usepackage{amssymb} % Extended symbol collection - also loads amsfonts
\usepackage{stmaryrd} % Extra symbols

%% Fonts
\usepackage{mathrsfs} % Support \mathcal and \mathscr

%% Environments
\usepackage{amsthm} % Use theorems

%% Tables and arrays
\usepackage{booktabs} % Top and bottom rule for tabular
\usepackage{tabularx} % Advanced Tables

%% Lists
\usepackage{enumitem} % Itemize, enumerate, description environments

%% Page layout
\usepackage{geometry} % Page layout customisation
\usepackage{fancyhdr} % Page headers and footers
\usepackage{float} % Float objects such as figures and tables
\usepackage{tcolorbox} % Create boxed environments

%% Text enhancements
\usepackage[none]{hyphenat} % Disable hyphenation of long text
\usepackage{ragged2e} % Text alignment options

%% Referencing
\usepackage{tocbibind} % Adds bibliography to the Table of Contents
\usepackage{url} % Define urls

%% Graphics
\usepackage{graphicx} % Extension to graphics
% \graphicspath{ {./figures/} }

%% Miscellaneous
\usepackage[outputdir=Debug]{minted} % Typeset programming code
\usepackage{siunitx} % SI units package
\usepackage{derivative} % Derivative notation
\usepackage{pdfpages} % Import PDFs into document

\usepackage[hidelinks]{hyperref} % Handle cross-referencing
\usepackage{bookmark} % New bookmark organisation for hyperref

%% Unicode setup
\usepackage[warnings-off={mathtools-colon, mathtools-overbracket}]{unicode-math}
\setmathfont{Latin Modern Math}
\setmathfont[range={bb, bbit}, Scale=MatchUppercase]{TeX Gyre Pagella Math}
\setmathfont[range={\mathcal, \mathbfcal}, StylisticSet=1]{XITS Math}
\setmathfont[range={\mathscr}]{XITS Math}
\setmathfont[range={"2205}]{XITS Math} % chktex 18

% Preamble

%% Misc Commands

%%% Number Sets
\newcommand*{\N}{\mathbb{N}}
\newcommand*{\Z}{\mathbb{Z}}
\newcommand*{\Q}{\mathbb{Q}}
\newcommand*{\I}{\mathbb{I}}
\newcommand*{\R}{\mathbb{R}}
\newcommand*{\C}{\mathbb{C}}

%%% Empty set character
\let\oldemptyset\emptyset
\let\varnothing\relax
\newcommand{\varnothing}{\char"2205} % chktex 18

%%% Contradiction
\newcommand{\contradiction}{
\hspace{-1em}
{\hbox{
\setbox0=\hbox{\(\mkern-3mu{\times}\mkern-3mu\)}
\setbox1=\hbox to0pt{\hss\copy0\hss}
\copy0\raisebox{0.5\wd0}{\copy1}\raisebox{-0.5\wd0}{\box1}\box0}}
}

%%% Lines for matrices
\newcommand*{\vertbar}{\rule[-1ex]{0.5pt}{2.5ex}}
\newcommand*{\horzbar}{\rule[.5ex]{2.5ex}{0.5pt}}

%% Paired Delimiters
\DeclarePairedDelimiter{\ceil}{\lceil}{\rceil}
\DeclarePairedDelimiter{\floor}{\lfloor}{\rfloor}
\DeclarePairedDelimiter{\abracket}{\langle}{\rangle}
\DeclarePairedDelimiter{\abs}{\lvert}{\rvert}
\DeclarePairedDelimiter{\norm}{\lVert}{\rVert}

%% Probability Functions
\let\Pr\relax
\DeclareMathOperator{\Pr}{Pr}
\DeclareMathOperator{\E}{E}
\DeclareMathOperator{\Var}{Var}
\DeclareMathOperator{\Cov}{Cov}
\DeclareMathOperator{\Corr}{Corr}

\newcommand{\Perm}[2]{\prescript{#1}{}{P}_{#2}}

%% Hyperbolic Functions
\DeclareMathOperator{\arcsinh}{arcsinh}
\DeclareMathOperator{\arccosh}{arccosh}
\DeclareMathOperator{\arctanh}{arctanh}
\DeclareMathOperator{\arccoth}{arccoth}
\DeclareMathOperator{\arcsech}{arcsech}
\DeclareMathOperator{\arccsch}{arccsch}

%% Linear Algebra
%%% Augmented matrices
\makeatletter
\renewcommand*\env@matrix[1][*\c@MaxMatrixCols c]{%
    \hskip -\arraycolsep
    \let\@ifnextchar\new@ifnextchar
    \array{#1}}
\makeatother

%%% Operators
\let\det\relax
\DeclareMathOperator{\det}{det}
\DeclareMathOperator{\Tr}{Tr}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\adj}{adj}

\DeclareMathOperator{\vspan}{span}
\DeclareMathOperator{\vref}{ref}
\DeclareMathOperator{\vrref}{rref}

\DeclareMathOperator{\vrank}{rank}
\DeclareMathOperator{\vnull}{null}

\DeclareMathOperator{\proj}{proj}

\DeclareMathOperator{\vim}{im}
\DeclareMathOperator{\vcoim}{coim}
\DeclareMathOperator{\vker}{ker}
\DeclareMathOperator{\vcoker}{coker}

\newcommand{\columnspace}[1]{\mathcal{C}\left(\symbf{#1}\right)}
\newcommand{\rowspace}[1]{\mathcal{C}\left(\symbf{#1}^{\top}\right)}
\newcommand{\nullspace}[1]{\mathcal{N}\left(\symbf{#1}\right)}
\newcommand{\leftnullspace}[1]{\mathcal{N}\left(\symbf{#1}^{\top}\right)}

%% Additional operators
\DeclareMathOperator{\erf}{erf}

% Theorems
\theoremstyle{definition}
\newtheorem{definition}{Definition}[section]

\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[subsection]
\newtheorem{corollary}{Corollary}[theorem]
\newtheorem{lemma}{Lemma}[theorem]
\newtheorem{axiom}{Axiom}

\theoremstyle{remark}
\newtheorem{remark}{Remark}
\newtheorem{note}{Note}[subsection]
\newtheorem*{statement}{Statement}

\newenvironment{examples}[1][Examples]{\let\qed\relax\proof[#1]\mbox{}\\*}{\endproof}
\newenvironment{question}[1][Question]{\let\qed\relax\proof[#1]\mbox{}\\*}{\endproof}
\newenvironment{solution}[1][Solution]{\let\qed\relax\proof[#1]\mbox{}\\*}{\endproof}

\newenvironment{proofcase}[1]{\proof[Case #1]\mbox{}}{\endproof}

%% Box styles
\tcbuselibrary{skins}
\newtcolorbox{tcolorboxlarge}[1][]{
    skin=enhanced,
    boxrule=0pt,
    frame hidden,
    sharp corners,
    borderline west={0.5pt}{0pt}{black},
    borderline east={0.5pt}{0pt}{black},
    enlarge left by=10pt,
    width=\linewidth-20pt,
    opacityback=0,
    coltitle=black,
    fonttitle=\large\bfseries,
    #1
}

\newtcolorbox{tcolorboxcols}[1][]{
    skin=enhanced,
    boxrule=0pt,
    frame hidden,
    sharp corners,
    borderline west={0.5pt}{0pt}{black},
    opacityback=0,
    coltitle=black,
    fonttitle=\large\bfseries,
    #1
}

%% Reset counter within subsections
\counterwithin*{equation}{section}
\counterwithin*{equation}{subsection}
\counterwithin*{remark}{subsection}

%% Page layout setup
\pagestyle{fancy}
\setlength\headheight{24pt}
\setlength\parindent{0pt} % Indent first line of new paragraphs
